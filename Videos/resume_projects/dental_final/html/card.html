<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Zirconia Warranty Card</title>
  <style>
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body {
      font-family: 'Arial', sans-serif;
      background: linear-gradient(to right, #a7cad5, #5dafd2);
      display: flex;
      flex-direction: column;
      min-height: 100vh;
      margin: 0;
    }

    .navbar {
      background: linear-gradient(90deg, #b6e2e2 0%, #eaf6f6 100%);
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.07);
      position: fixed;
      top: 0;
      width: 100%;
      z-index: 1000;
    }

    .navbar ul {
      list-style: none;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 0 24px;
      height: 60px;
      margin: 0;
    }

    .navbar li {
      margin: 0 12px;
    }

    .navbar .nav-link {
      padding: 12px 20px;
      color: #1e7fa7;
      text-decoration: none;
      font-weight: 500;
      border-radius: 6px;
      transition: all 0.2s ease;
    }

    .navbar .nav-link.active,
    .navbar .nav-link:hover {
      background: #1e7fa7;
      color: #fff;
    }

    .content-wrapper {
      flex: 1;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      padding: 80px 20px;
      min-height: 100vh;
    }

    .card-container {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 24px;
      width: 100%;
      max-width: 450px;
    }

    .card {
      width: 370px;
      height: 230px;
      border-radius: 18px;
      box-shadow: 0 4px 24px rgba(0, 0, 0, 0.18);
      background: linear-gradient(135deg, #eaf6f6 60%, #a3dbdb 100%);
      position: relative;
      padding: 24px;
      display: flex;
      flex-direction: column;
      justify-content: space-between;
    }

    .card-title {
      position: absolute;
      right: 18px;
      top: 18px;
      font-size: 1.5em;
      font-weight: bold;
      color: #2d3a3a;
      writing-mode: vertical-rl;
      text-orientation: mixed;
      letter-spacing: 2px;
    }

    .card-content {
      display: flex;
      flex-direction: row;
      height: 100%;
    }

    .card-fields {
      flex: 2;
      display: flex;
      flex-direction: column;
      justify-content: flex-start;
      gap: 8px;
      font-size: 0.95em;
    }

    .card-fields .field-row {
      display: flex;
      align-items: baseline;
      gap: 8px;
    }

    .card-fields label {
      font-weight: bold;
      letter-spacing: 0.5px;
      color: #2d3a3a;
      width: 80px;
    }

    .card-fields .colon {
      font-weight: bold;
      margin-right: 4px;
    }

    .card-fields .field-value {
      color: #333;
    }

    .card-badge {
      flex: 1;
      display: flex;
      align-items: flex-end;
      justify-content: flex-start;
    }

    .warranty-badge {
      background: #1e7fa7;
      color: #fff;
      border-radius: 50%;
      width: 70px;
      height: 70px;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      font-weight: bold;
      font-size: 0.8em;
      border: 4px solid #fff;
      box-shadow: 0 2px 8px rgba(30, 127, 167, 0.18);
    }

    .warranty-badge span {
      font-size: 0.5em;
      letter-spacing: 1px;
    }

    .warranty-badge small {
      font-size: 1em;
      font-weight: normal;
      letter-spacing: 0.5px;
    }

    .card-logo {
      position: absolute;
      right: 18px;
      bottom: 18px;
      width: 90px;
      height: 32px;
      opacity: 0.8;
    }

    .card-logo img {
      max-width: 100%;
      max-height: 100%;
    }

    .form-container {
      background: #fff;
      padding: 24px;
      border-radius: 12px;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
      border: 2px solid #333;
      width: 100%;
      max-width: 370px;
    }

    .form-container h2 {
      color: #091254;
      font-size: 18px;
      margin-bottom: 16px;
      text-align: center;
    }

    .form-row {
      display: flex;
      flex-direction: column;
      gap: 8px;
      margin-bottom: 16px;
    }

    .form-row label {
      color: #04113e;
      font-weight: 500;
      font-size: 14px;
    }

    .form-row input {
      padding: 10px;
      border: 1px solid #0b76d3;
      border-radius: 5px;
      font-size: 14px;
      width: 100%;
      transition: border-color 0.3s, box-shadow 0.3s;
    }

    .form-row input:focus {
      outline: none;
      border-color: #080707;
      box-shadow: 0 0 5px rgba(6, 84, 117, 0.5);
    }

    .card-actions {
      display: flex;
      justify-content: center;
      width: 100%;
    }

    #generatePdfBtn {
      padding: 12px 24px;
      font-size: 16px;
      border-radius: 6px;
      background: #1e7fa7;
      color: #fff;
      border: none;
      cursor: pointer;
      transition: background-color 0.3s ease;
    }

    #generatePdfBtn:hover {
      background: #155d7a;
    }

    #cardBackText {
      display: none;
      font-size: 0.98em;
      color: #333;
    }

    @media (max-width: 480px) {
      .card, .form-container {
        width: 90%;
        max-width: 320px;
      }

      .card {
        height: auto;
        padding: 18px;
      }

      .card-title {
        font-size: 1.2em;
        right: 12px;
        top: 12px;
      }

      .card-fields {
        font-size: 0.85em;
      }

      .warranty-badge {
        width: 60px;
        height: 60px;
        font-size: 0.7em;
      }

      .card-logo {
        right: 12px;
        bottom: 12px;
        width: 70px;
        height: 25px;
      }
    }
  </style>
</head>
<body>
  <nav class="navbar">
    <ul>
      <li><a href="patients.html" class="nav-link" id="nav-patients">Patients</a></li>
      <li><a href="home.html" class="nav-link" id="nav-home">Home</a></li>
      <li><a href="materials.html" class="nav-link" id="nav-materials">Materials</a></li>
      <li><a href="note.html" class="nav-link" id="nav-note">Note</a></li>
      <li><a href="card.html" class="nav-link active" id="nav-card">Card</a></li>
      <li><a href="salary.html" class="nav-link" id="nav-salary">Salary</a></li>
      <li><a href="register.html" class="nav-link" id="nav-register">Register</a></li>
      <li><a href="invoice.html" class="nav-link" id="nav-invoice">Invoice</a></li>
      <li><a href="exp.html" class="nav-link" id="nav-exp">Expenses</a></li>
      <li><a href="challan.html" class="nav-link" id="nav-exp">Delivery Challan</a></li>

    </ul>
  </nav>

  <div class="content-wrapper">
    <div class="card-container">
      <div class="form-container">
        <h2>Warranty Card Details</h2>
        <form id="warrantyForm">
          <div class="form-row">
            <label for="dentist">Dentist Name</label>
            <input type="text" id="dentist" name="dentist" value="DR. PRITI BHAKSAR" required aria-required="true">
          </div>
          <div class="form-row">
            <label for="jobNo">Job No.</label>
            <input type="text" id="jobNo" name="jobNo" value="JUN0147" required aria-required="true">
          </div>
          <div class="form-row">
            <label for="patient">Patient Name</label>
            <input type="text" id="patient" name="patient" value="MANAK DHAWAN" required aria-required="true">
          </div>
          <div class="form-row">
            <label for="validFrom">Valid From</label>
            <input type="date" id="validFrom" name="validFrom" value="2022-06-14" required aria-required="true">
          </div>
        </form>
      </div>

      <div class="card">
        <div class="card-title">WellDent</div>
        <div class="card-content">
          <div class="card-fields">
            <div class="field-row"><label>DENTIST</label><span class="colon">:</span><span class="field-value" id="cardDentist">DR. PRITI BHAKSAR</span></div>
            <div class="field-row"><label>JOB NO</label><span class="colon">:</span><span class="field-value" id="cardJobNo">JUN0147</span></div>
            <div class="field-row"><label>PATIENT</label><span class="colon">:</span><span class="field-value" id="cardPatient">MANAK DHAWAN</span></div>
            <div class="field-row"><label>VALID FROM</label><span class="colon">:</span><span class="field-value" id="cardValidFrom">14/06/2022</span></div>
          </div>
          <div class="card-badge">
            <div class="warranty-badge">
              <span>5 YEARS</span>
              <small>WARRANTY</small>
            </div>
          </div>
        </div>
        <div class="card-logo">
          <img src="https://i.imgur.com/0y8Ftya.png" alt="Toothfairy Dental Lab Logo" aria-label="Toothfairy Dental Lab Logo">
        </div>
      </div>

      <div class="card-actions">
        <button id="generatePdfBtn">Generate PDF</button>
      </div>
    </div>
  </div>

  <div id="cardBackText" style="display:none;">
    <h3 style="text-align:center;">Warranty Terms & Conditions</h3>
    <div style="font-size:0.98em;">
      <p><b>* Your dental restoration is warranted by Toothfairy Dental Lab</b></p>
      <p><b>What is covered*</b><br>1. Repair or replacement of your dental prosthesis</p>
      <p><b>What is not covered*</b><br>
        1. Cash refund for prosthesis<br>
        2. Cost incurred from removal / insertion<br>
        3. Repairs resulting from accident, negligence, defect, abuse, failure of supportive tooth or tissue structure, or improper dental hygiene<br>
        4. Chair time or pain and suffering, including inconvenience, loss wages<br>
        5. Shipping cost for repair and replacement of prosthesis<br>
        6. Dental fees for repair and replacement of prosthesis
      </p>
      <p><b>Conditions must be met for warranty to apply</b><br>
        1. Prosthesis must be inserted by a licensed, practicing dentist.<br>
        2. Dental prosthetic must be returned with model work and warranty card in order for the credit to be issued or remake the prosthesis
      </p>
      <p><b>Subject to Mumbai Court's Jurisdiction only</b><br>
        * Warranty terms and conditions are subject to change without notice.
      </p>
    </div>
  </div>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
  <script>
    // Update card display when form inputs change
    const formInputs = document.querySelectorAll('#warrantyForm input');
    formInputs.forEach(input => {
      input.addEventListener('input', () => {
        const fieldName = input.name;
        const value = input.type === 'date' ? input.value.split('-').reverse().join('/') : input.value.toUpperCase();
        document.getElementById(`card${fieldName.charAt(0).toUpperCase() + fieldName.slice(1)}`).textContent = value;
      });
    });

    document.getElementById('generatePdfBtn').addEventListener('click', async function () {
      try {
        const { jsPDF } = window.jspdf;
        const cardWidth = 370;
        const cardHeight = 230;
        const margin = 20;
        const pdfWidth = cardWidth + 2 * margin;
        const pdfHeight = cardHeight + 2 * margin;
        const doc = new jsPDF({ unit: 'pt', format: [pdfWidth, pdfHeight], orientation: 'landscape' });

        // Generate front page (card)
        const canvas = await html2canvas(document.querySelector('.card'), { scale: 2 });
        const imgData = canvas.toDataURL('image/png');
        doc.addImage(imgData, 'PNG', margin, margin, cardWidth, cardHeight);

        // Generate back page (terms)
        doc.addPage([pdfWidth, pdfHeight], 'landscape');
        doc.setFont('helvetica', 'normal');
        let yText = margin + 18;

        doc.setFontSize(16);
        doc.text('Warranty Terms & Conditions', pdfWidth / 2, yText, { align: 'center' });
        yText += 22;

        doc.setFontSize(11);
        const lines = [
          '* Your dental restoration is warranted by Toothfairy Dental Lab',
          '',
          'What is covered*',
          '1. Repair or replacement of your dental prosthesis',
          '',
          'What is not covered*',
          '1. Cash refund for prosthesis',
          '2. Cost incurred from removal / insertion',
          '3. Repairs resulting from accident, negligence, defect, abuse, failure of supportive tooth or tissue structure, or improper dental hygiene',
          '4. Chair time or pain and suffering, including inconvenience, loss wages',
          '5. Shipping cost for repair and replacement of prosthesis',
          '6. Dental fees for repair and replacement of prosthesis',
          '',
          'Conditions must be met for warranty to apply',
          '1. Prosthesis must be inserted by a licensed, practicing dentist.',
          '2. Dental prosthetic must be returned with model work and warranty card in order for the credit to be issued or remake the prosthesis',
          '',
          "Subject to Mumbai Court's Jurisdiction only",
          '* Warranty terms and conditions are subject to change without notice.'
        ];

        lines.forEach(line => {
          const split = doc.splitTextToSize(line, pdfWidth - 2 * margin);
          split.forEach(subline => {
            if (yText > pdfHeight - margin) {
              doc.addPage([pdfWidth, pdfHeight], 'landscape');
              yText = margin + 18;
            }
            doc.text(subline, margin, yText);
            yText += 16;
          });
        });

        // Generate filename based on patient name and date
        const patientName = document.getElementById('patient').value || 'Unknown';
        const safePatientName = patientName.replace(/[^a-z0-9]/gi, '_').toLowerCase();
        const dateString = new Date().toISOString().slice(0, 10);
        doc.save(`warranty_card_${safePatientName}_${dateString}.pdf`);
      } catch (error) {
        console.error('Error generating PDF:', error);
        alert('An error occurred while generating the PDF. Please try again.');
      }
    });

    document.addEventListener('DOMContentLoaded', function() {
      const path = window.location.pathname;
      const navLinks = {
        'materials.html': 'nav-materials',
        'note.html': 'nav-note',
        'card.html': 'nav-card',
        'salary.html': 'nav-salary'
      };

      for (const [page, id] of Object.entries(navLinks)) {
        if (path.includes(page)) {
          document.getElementById(id)?.classList.add('active');
        }
      }
    });
  </script>
</body>
</html>